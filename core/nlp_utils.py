import re
from typing import List, Dict, Tuple

# ğŸ”¹ à¹‚à¸Ÿà¸à¸±à¸ªà¹‚à¸£à¸„à¹€à¸”à¸µà¸¢à¸§: à¹‚à¸„à¸§à¸´à¸”
DISEASE_KEYWORDS = ["à¹‚à¸„à¸§à¸´à¸”", "COVID", "covid-19", "COVID-19"]

# ğŸ”¹ à¸›à¸£à¸°à¹€à¸—à¸¨à¸ªà¸³à¸„à¸±à¸à¹ƒà¸™à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œ
COUNTRY_KEYWORDS = ["à¹„à¸—à¸¢", "à¸›à¸£à¸°à¹€à¸—à¸¨à¹„à¸—à¸¢", "à¹€à¸à¸²à¸«à¸¥à¸µ", "à¹€à¸à¸²à¸«à¸¥à¸µà¹ƒà¸•à¹‰", "à¸›à¸£à¸°à¹€à¸—à¸¨", "à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”"]

# ğŸ”¹ à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸” 77 à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”à¸‚à¸­à¸‡à¹„à¸—à¸¢
PROVINCE_KEYWORDS = [
    "à¸à¸£à¸¸à¸‡à¹€à¸—à¸à¸¡à¸«à¸²à¸™à¸„à¸£", "à¸à¸£à¸°à¸šà¸µà¹ˆ", "à¸à¸²à¸à¸ˆà¸™à¸šà¸¸à¸£à¸µ", "à¸à¸²à¸¬à¸ªà¸´à¸™à¸˜à¸¸à¹Œ", "à¸à¸³à¹à¸à¸‡à¹€à¸à¸Šà¸£", "à¸‚à¸­à¸™à¹à¸à¹ˆà¸™", "à¸ˆà¸±à¸™à¸—à¸šà¸¸à¸£à¸µ", "à¸‰à¸°à¹€à¸Šà¸´à¸‡à¹€à¸—à¸£à¸²",
    "à¸Šà¸¥à¸šà¸¸à¸£à¸µ", "à¸Šà¸±à¸¢à¸™à¸²à¸—", "à¸Šà¸±à¸¢à¸ à¸¹à¸¡à¸´", "à¸Šà¸¸à¸¡à¸à¸£", "à¹€à¸Šà¸µà¸¢à¸‡à¸£à¸²à¸¢", "à¹€à¸Šà¸µà¸¢à¸‡à¹ƒà¸«à¸¡à¹ˆ", "à¸•à¸£à¸±à¸‡", "à¸•à¸£à¸²à¸”", "à¸•à¸²à¸", "à¸™à¸„à¸£à¸™à¸²à¸¢à¸",
    "à¸™à¸„à¸£à¸›à¸à¸¡", "à¸™à¸„à¸£à¸à¸™à¸¡", "à¸™à¸„à¸£à¸£à¸²à¸Šà¸ªà¸µà¸¡à¸²", "à¸™à¸„à¸£à¸¨à¸£à¸µà¸˜à¸£à¸£à¸¡à¸£à¸²à¸Š", "à¸™à¸„à¸£à¸ªà¸§à¸£à¸£à¸„à¹Œ", "à¸™à¸™à¸—à¸šà¸¸à¸£à¸µ", "à¸™à¸£à¸²à¸˜à¸´à¸§à¸²à¸ª", "à¸™à¹ˆà¸²à¸™",
    "à¸šà¸¶à¸‡à¸à¸²à¸¬", "à¸šà¸¸à¸£à¸µà¸£à¸±à¸¡à¸¢à¹Œ", "à¸›à¸—à¸¸à¸¡à¸˜à¸²à¸™à¸µ", "à¸›à¸£à¸°à¸ˆà¸§à¸šà¸„à¸µà¸£à¸µà¸‚à¸±à¸™à¸˜à¹Œ", "à¸›à¸£à¸²à¸ˆà¸µà¸™à¸šà¸¸à¸£à¸µ", "à¸›à¸±à¸•à¸•à¸²à¸™à¸µ", "à¸à¸£à¸°à¸™à¸„à¸£à¸¨à¸£à¸µà¸­à¸¢à¸¸à¸˜à¸¢à¸²",
    "à¸à¸°à¹€à¸¢à¸²", "à¸à¸±à¸‡à¸‡à¸²", "à¸à¸±à¸—à¸¥à¸¸à¸‡", "à¸à¸´à¸ˆà¸´à¸•à¸£", "à¸à¸´à¸©à¸“à¸¸à¹‚à¸¥à¸", "à¹€à¸à¸Šà¸£à¸šà¸¸à¸£à¸µ", "à¹€à¸à¸Šà¸£à¸šà¸¹à¸£à¸“à¹Œ", "à¹à¸à¸£à¹ˆ", "à¸ à¸¹à¹€à¸à¹‡à¸•",
    "à¸¡à¸«à¸²à¸ªà¸²à¸£à¸„à¸²à¸¡", "à¸¡à¸¸à¸à¸”à¸²à¸«à¸²à¸£", "à¹à¸¡à¹ˆà¸®à¹ˆà¸­à¸‡à¸ªà¸­à¸™", "à¸¢à¸°à¸¥à¸²", "à¸¢à¹‚à¸ªà¸˜à¸£", "à¸£à¹‰à¸­à¸¢à¹€à¸­à¹‡à¸”", "à¸£à¸°à¸™à¸­à¸‡", "à¸£à¸°à¸¢à¸­à¸‡",
    "à¸£à¸²à¸Šà¸šà¸¸à¸£à¸µ", "à¸¥à¸à¸šà¸¸à¸£à¸µ", "à¸¥à¸³à¸›à¸²à¸‡", "à¸¥à¸³à¸à¸¹à¸™", "à¹€à¸¥à¸¢", "à¸¨à¸£à¸µà¸ªà¸°à¹€à¸à¸©", "à¸ªà¸à¸¥à¸™à¸„à¸£", "à¸ªà¸‡à¸‚à¸¥à¸²", "à¸ªà¸•à¸¹à¸¥",
    "à¸ªà¸¡à¸¸à¸—à¸£à¸›à¸£à¸²à¸à¸²à¸£", "à¸ªà¸¡à¸¸à¸—à¸£à¸ªà¸‡à¸„à¸£à¸²à¸¡", "à¸ªà¸¡à¸¸à¸—à¸£à¸ªà¸²à¸„à¸£", "à¸ªà¸£à¸°à¹à¸à¹‰à¸§", "à¸ªà¸£à¸°à¸šà¸¸à¸£à¸µ", "à¸ªà¸´à¸‡à¸«à¹Œà¸šà¸¸à¸£à¸µ", "à¸ªà¸¸à¹‚à¸‚à¸—à¸±à¸¢",
    "à¸ªà¸¸à¸à¸£à¸£à¸“à¸šà¸¸à¸£à¸µ", "à¸ªà¸¸à¸£à¸²à¸©à¸à¸£à¹Œà¸˜à¸²à¸™à¸µ", "à¸ªà¸¸à¸£à¸´à¸™à¸—à¸£à¹Œ", "à¸«à¸™à¸­à¸‡à¸„à¸²à¸¢", "à¸«à¸™à¸­à¸‡à¸šà¸±à¸§à¸¥à¸³à¸ à¸¹", "à¸­à¹ˆà¸²à¸‡à¸—à¸­à¸‡", "à¸­à¸¸à¸”à¸£à¸˜à¸²à¸™à¸µ",
    "à¸­à¸¸à¸—à¸±à¸¢à¸˜à¸²à¸™à¸µ", "à¸­à¸¸à¸•à¸£à¸”à¸´à¸•à¸–à¹Œ", "à¸­à¸¸à¸šà¸¥à¸£à¸²à¸Šà¸˜à¸²à¸™à¸µ", "à¸­à¸³à¸™à¸²à¸ˆà¹€à¸ˆà¸£à¸´à¸"
]

# ğŸ”¹ à¸£à¸§à¸¡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¹€à¸à¸·à¹ˆà¸­à¹ƒà¸Šà¹‰à¸„à¹‰à¸™à¸«à¸²
LOCATION_KEYWORDS = COUNTRY_KEYWORDS + PROVINCE_KEYWORDS

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ” Extract Keywords (Disease, Location)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def extract_keywords(text: str) -> Dict[str, List[str]]:
    """à¸”à¸¶à¸‡à¸„à¸³à¸ªà¸³à¸„à¸±à¸à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¹‚à¸£à¸„à¹à¸¥à¸°à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆà¸ˆà¸²à¸à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡"""
    diseases = [kw for kw in DISEASE_KEYWORDS if kw.lower() in text.lower()]
    locations = [kw for kw in LOCATION_KEYWORDS if kw in text]
    return {
        "diseases": list(set(diseases)),
        "locations": list(set(locations))
    }

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ” Extract Named Entities (NER)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def simple_ner(text: str) -> List[Tuple[str, str]]:
    """
    à¸„à¸·à¸™ entity à¸—à¸±à¹‰à¸‡à¹‚à¸£à¸„à¹à¸¥à¸°à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆ à¹€à¸Šà¹ˆà¸™:
    - ("à¹‚à¸„à¸§à¸´à¸”", "DISEASE")
    - ("à¹€à¸à¸²à¸«à¸¥à¸µà¹ƒà¸•à¹‰", "LOCATION")
    - ("à¹€à¸Šà¸µà¸¢à¸‡à¹ƒà¸«à¸¡à¹ˆ", "LOCATION")
    """
    entities = []

    for word in DISEASE_KEYWORDS:
        if re.search(rf"\b{re.escape(word)}\b", text, re.IGNORECASE):
            entities.append((word, "DISEASE"))

    for place in LOCATION_KEYWORDS:
        if place in text:
            entities.append((place, "LOCATION"))

    return list(set(entities))

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ§µ Convert to Hashtags
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def generate_hashtags(text: str) -> List[str]:
    """à¹à¸›à¸¥à¸‡ entity à¸—à¸µà¹ˆà¹€à¸ˆà¸­à¹ƒà¸«à¹‰à¹€à¸›à¹‡à¸™à¹à¸®à¸Šà¹à¸—à¹‡à¸ à¹€à¸Šà¹ˆà¸™ #à¹‚à¸„à¸§à¸´à¸” #à¹€à¸à¸²à¸«à¸¥à¸µ #à¹€à¸Šà¸µà¸¢à¸‡à¹ƒà¸«à¸¡à¹ˆ"""
    keywords = extract_keywords(text)
    tags = keywords["diseases"] + keywords["locations"]
    return [f"#{tag}" for tag in sorted(set(tags))]

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”¬ à¸—à¸”à¸ªà¸­à¸š
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if __name__ == "__main__":
    test_text = "à¹€à¸à¸²à¸«à¸¥à¸µà¹ƒà¸•à¹‰à¸à¸šà¸œà¸¹à¹‰à¸•à¸´à¸”à¹€à¸Šà¸·à¹‰à¸­à¹‚à¸„à¸§à¸´à¸”à¹€à¸”à¸´à¸™à¸—à¸²à¸‡à¹€à¸‚à¹‰à¸²à¹„à¸—à¸¢ à¹à¸¥à¸°à¸à¸šà¹ƒà¸™à¹€à¸Šà¸µà¸¢à¸‡à¹ƒà¸«à¸¡à¹ˆ"
    print("ğŸ§ª Keywords:", extract_keywords(test_text))
    print("ğŸ§  NER:", simple_ner(test_text))
    print("ğŸ·ï¸ Hashtags:", generate_hashtags(test_text))
